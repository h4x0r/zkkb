direction: down

device: YOUR DEVICE {
  style.fill: "#d0ebff"
  style.stroke: "#1971c2"
  style.stroke-width: 3
  style.font-size: 64

  recovery: "ðŸ”‘ Recovery Phrase" {
    shape: rectangle
    style.fill: "#ffffff"
    style.font-size: 48

    label: |md
      **Recovery Phrase**
      24 words (BIP-39)
    |
  }

  seed: "ðŸ”„ Derive Seed" {
    shape: rectangle
    style.fill: "#ffffff"
    style.font-size: 48

    label: |md
      **Derive Seed**
      PBKDF2
      100k iterations
    |
  }

  keys: "ðŸ” Identity Keys" {
    shape: rectangle
    style.fill: "#ffffff"
    style.font-size: 48

    label: |md
      **Identity Keys**
      â€¢ publicKey
      â€¢ privateKey
      â€¢ zkIdentity (X25519)
    |
  }

  encryption: "ðŸ”’ Board Encryption" {
    shape: rectangle
    style.fill: "#fff3bf"
    style.font-size: 48

    label: |md
      **Board Encryption**
      Your Data â†’ AES-256-GCM â†’ Encrypted Blob
    |
  }

  recovery -> seed -> keys
  keys -> encryption
}

internet: "ðŸ”’ INTERNET (Encrypted TLS)" {
  shape: rectangle
  style.fill: "#f1f3f5"
  style.stroke: "#495057"
  style.stroke-width: 2
  style.font-size: 56
}

cloud: CLOUDFLARE EDGE {
  style.fill: "#ffe8cc"
  style.stroke: "#fd7e14"
  style.stroke-width: 3
  style.font-size: 64

  d1: D1 - Metadata {
    shape: rectangle
    style.fill: "#ffffff"
    style.font-size: 48

    label: |md
      **D1 - Metadata**
      â€¢ user IDs
      â€¢ board IDs
      â€¢ merkle roots
    |
  }

  r2: R2 - Blobs {
    shape: rectangle
    style.fill: "#ffffff"
    style.font-size: 48

    label: |md
      **R2 - Blobs**
      â€¢ encrypted board data
      â€¢ encrypted files
    |
  }

  do: Durable Objects {
    shape: rectangle
    style.fill: "#ffffff"
    style.font-size: 48

    label: |md
      **Durable Objects**
      WebSocket Sync
      â€¢ broadcast
      â€¢ presence
      â€¢ connection
    |
  }
}

warning: "âŒ Server CANNOT see" {
  shape: rectangle
  style.fill: "#fff5f5"
  style.stroke: "#c92a2a"
  style.stroke-width: 2
  style.font-size: 48

  label: |md
    Server CANNOT see:
    card content, member names, file contents
  |
}

device.encryption -> internet: " "
internet -> cloud: " "
cloud -> warning: " "
